<!DOCTYPE html>
<html>
<head>
    <title>Survey Page</title>
    <style>
        textarea {
            width: 100%; /* 设置文本框宽度 */
            height: 100px; /* 设置文本框高度 */
        }

        /* 设置 Name、Email 和 Organization 输入框宽度 */
        input[name="Name"],
        input[name="Email"],
        input[name="Organization"] {
            width: 50%; /* 设置输入框宽度为 100% */
        }
    </style>
</head>
<body>
    <form id="surveyForm">
        <p>Name: <input type="text" name="Name"></p>
        <p>Email: <input type="text" name="Email"></p>
        <p>Organization: <input type="text" name="Organization"></p>
        <p>Please specify where and how you intend to utilize our datasets:</p>
        <textarea name="Reason"></textarea> <!-- 更大的文本框 -->
        <button type="submit">Submit Survey</button>
    </form>
    
    <!-- 添加用户信息处理声明 -->
    <div id="userInformationStatement">
        <h3>User Information Processing Statement</h3>
        <p>Welcome to our website! We value your privacy and the protection of your personal information. When you use our services and submit personal information, we will process your information as follows:</p>
        <p>Information Collection: We only collect personal information necessary to provide our services, such as your name, email address, and contact details.</p>
        <p>Use of Information: Your personal information will be used for the following purposes: to provide and improve our services, customer support, communication with you, website administration, and other uses permitted or required by law.</p>
        <p>Sharing and Disclosure of Information: We will not share your personal information with third parties unless we have your explicit consent or it is necessary for providing our services or required by law.</p>
        <p>Data Security: We take appropriate security measures to protect your personal information from unauthorized access and disclosure.</p>
        <p>User Rights: You have the right to access, correct, or delete your personal information, and in certain circumstances, to restrict or object to the processing of your information.</p>
        <p>Policy Updates: We may update this statement to reflect changes in our policies. We encourage users to regularly review this page for the latest information.</p>
        <p>Contact Information: If you have any questions about how we process your personal information, please contact us at [contact information].</p>
        <p>By continuing to use our website, you acknowledge and agree to this statement.</p>
    </div>

    <script>
        document.getElementById('surveyForm').addEventListener('submit', function(e) {
            console.log("表单正在提交");  // 调试信息
            e.preventDefault();

            // 检查所有字段是否已填写
            var formData = new FormData(document.getElementById('surveyForm'));
            var isFormComplete = true;

            for (var [key, value] of formData.entries()) {
                if (value.trim() === '') {
                    alert(key + ' is required');
                    isFormComplete = false;
                    break;
                }
            }

            if (isFormComplete) {
                // 发送数据到服务器
                fetch('http://127.0.0.1:5000/submit-survey', {
                    method: 'POST',
                    body: formData
                }).then(response => {
                    if (response.ok) {
                        // 成功后跳转到下载页面
                        window.location.href = 'http://127.0.0.1:5000/static/download-link.html';
                    } else {
                        alert('Failed to submit survey');
                    }
                }).catch(error => {
                    console.error('Error:', error);
                    alert('An error occurred');
                });
            }
        });
    </script>
</body>
</html>
